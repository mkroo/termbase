<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head th:replace="~{layout/default :: head('ë°ëª¨')}">
    <title>ë°ëª¨</title>
</head>
<body class="bg-white dark:bg-notion-bg-dark min-h-screen">
    <nav th:replace="~{layout/default :: nav}"></nav>

    <main class="max-w-6xl mx-auto px-6 py-8">
        <!-- Header -->
        <h1 class="text-3xl font-bold text-notion-text dark:text-notion-text-dark mb-2">ë°ëª¨</h1>
        <p class="text-sm text-notion-text-secondary dark:text-notion-text-secondary-dark mb-8">
            Slack ëŒ€í™” ìˆ˜ì§‘ ë° Elasticsearch ë°ì´í„° ì¡°íšŒ
        </p>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Left: Slack Import -->
            <div class="border border-notion-border dark:border-notion-border-dark rounded-lg">
                <div class="border-b border-notion-border dark:border-notion-border-dark px-4 py-3 bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark rounded-t-lg">
                    <h2 class="text-sm font-semibold text-notion-text dark:text-notion-text-dark">Slack ëŒ€í™” ìˆ˜ì§‘</h2>
                </div>

                <div class="p-4">
                    <!-- Token Error Message -->
                    <div id="tokenError" class="hidden mb-4 px-3 py-2 text-sm bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800 rounded"></div>

                    <!-- Success Message -->
                    <div id="collectSuccess" class="hidden mb-4 px-3 py-2 text-sm bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800 rounded"></div>

                    <!-- Bot Token -->
                    <div class="mb-4">
                        <label for="botToken" class="block text-xs font-medium text-notion-text-secondary dark:text-notion-text-secondary-dark uppercase tracking-wider mb-2">
                            Bot Token
                        </label>
                        <div class="flex gap-2">
                            <input type="password" id="botToken"
                                   class="flex-1 px-3 py-2 text-sm bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark
                                          border border-notion-border dark:border-notion-border-dark rounded
                                          text-notion-text dark:text-notion-text-dark
                                          placeholder-notion-text-secondary dark:placeholder-notion-text-secondary-dark
                                          focus:outline-none focus:ring-1 focus:ring-notion-accent focus:border-notion-accent"
                                   placeholder="xoxb-...">
                            <button type="button" id="loadChannelsBtn"
                                    class="px-3 py-2 text-sm bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark
                                           border border-notion-border dark:border-notion-border-dark rounded
                                           text-notion-text dark:text-notion-text-dark
                                           hover:bg-notion-bg-hover dark:hover:bg-notion-bg-hover-dark transition
                                           disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap">
                                ì±„ë„ ë¶ˆëŸ¬ì˜¤ê¸°
                            </button>
                        </div>
                    </div>

                    <!-- Channel Section (hidden until loaded) -->
                    <div id="channelSection" class="hidden space-y-4">
                        <div>
                            <label class="block text-xs font-medium text-notion-text-secondary dark:text-notion-text-secondary-dark uppercase tracking-wider mb-2">
                                ì›Œí¬ìŠ¤í˜ì´ìŠ¤
                                <span id="workspaceName" class="ml-1 text-notion-text dark:text-notion-text-dark font-normal normal-case"></span>
                                <span id="channelCount" class="ml-1 text-notion-text-secondary dark:text-notion-text-secondary-dark font-normal normal-case"></span>
                            </label>
                        </div>

                        <input type="hidden" id="workspaceId">

                        <div>
                            <label for="channelSearch" class="block text-xs font-medium text-notion-text-secondary dark:text-notion-text-secondary-dark uppercase tracking-wider mb-2">
                                ì±„ë„ ê²€ìƒ‰
                            </label>
                            <input type="text" id="channelSearch"
                                   class="w-full px-3 py-2 text-sm bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark
                                          border border-notion-border dark:border-notion-border-dark rounded
                                          text-notion-text dark:text-notion-text-dark
                                          placeholder-notion-text-secondary dark:placeholder-notion-text-secondary-dark
                                          focus:outline-none focus:ring-1 focus:ring-notion-accent focus:border-notion-accent"
                                   placeholder="ì±„ë„ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰...">
                        </div>

                        <div>
                            <label for="channelId" class="block text-xs font-medium text-notion-text-secondary dark:text-notion-text-secondary-dark uppercase tracking-wider mb-2">
                                ì±„ë„ ì„ íƒ
                            </label>
                            <select id="channelId" size="6"
                                    class="w-full px-3 py-2 text-sm bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark
                                           border border-notion-border dark:border-notion-border-dark rounded
                                           text-notion-text dark:text-notion-text-dark
                                           focus:outline-none focus:ring-1 focus:ring-notion-accent focus:border-notion-accent">
                            </select>
                        </div>

                        <!-- Date Range -->
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label for="oldestDate" class="block text-xs font-medium text-notion-text-secondary dark:text-notion-text-secondary-dark uppercase tracking-wider mb-2">
                                    ì‹œì‘ì¼
                                </label>
                                <input type="datetime-local" id="oldestDate"
                                       class="w-full px-3 py-2 text-sm bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark
                                              border border-notion-border dark:border-notion-border-dark rounded
                                              text-notion-text dark:text-notion-text-dark
                                              focus:outline-none focus:ring-1 focus:ring-notion-accent focus:border-notion-accent">
                            </div>
                            <div>
                                <label for="latestDate" class="block text-xs font-medium text-notion-text-secondary dark:text-notion-text-secondary-dark uppercase tracking-wider mb-2">
                                    ì¢…ë£Œì¼
                                </label>
                                <input type="datetime-local" id="latestDate"
                                       class="w-full px-3 py-2 text-sm bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark
                                              border border-notion-border dark:border-notion-border-dark rounded
                                              text-notion-text dark:text-notion-text-dark
                                              focus:outline-none focus:ring-1 focus:ring-notion-accent focus:border-notion-accent">
                            </div>
                        </div>

                        <button type="button" id="collectBtn" disabled
                                class="w-full px-4 py-2 text-sm bg-notion-accent text-white rounded hover:opacity-90 transition
                                       disabled:opacity-50 disabled:cursor-not-allowed">
                            ìˆ˜ì§‘ ì‹œì‘
                        </button>
                    </div>
                </div>
            </div>

            <!-- Right: Source Documents -->
            <div class="border border-notion-border dark:border-notion-border-dark rounded-lg">
                <div class="border-b border-notion-border dark:border-notion-border-dark px-4 py-3 bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark rounded-t-lg flex items-center justify-between">
                    <h2 class="text-sm font-semibold text-notion-text dark:text-notion-text-dark">ì ì¬ëœ ëŒ€í™”</h2>
                    <div class="flex items-center gap-2">
                        <span id="docCount" class="text-xs text-notion-text-secondary dark:text-notion-text-secondary-dark">0ê°œ</span>
                        <button type="button" id="refreshBtn"
                                class="px-2 py-1 text-xs bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark
                                       border border-notion-border dark:border-notion-border-dark rounded
                                       text-notion-text dark:text-notion-text-dark
                                       hover:bg-notion-bg-hover dark:hover:bg-notion-bg-hover-dark transition">
                            ìƒˆë¡œê³ ì¹¨
                        </button>
                    </div>
                </div>

                <div id="documentsContainer" class="p-4 max-h-[600px] overflow-y-auto">
                    <div id="emptyState" class="text-center py-8 text-notion-text-secondary dark:text-notion-text-secondary-dark text-sm">
                        ì ì¬ëœ ëŒ€í™”ê°€ ì—†ìŠµë‹ˆë‹¤.
                    </div>
                    <div id="documentsList" class="hidden space-y-3"></div>
                </div>

                <!-- Pagination -->
                <div id="pagination" class="hidden border-t border-notion-border dark:border-notion-border-dark px-4 py-3 flex items-center justify-between">
                    <span id="pageInfo" class="text-xs text-notion-text-secondary dark:text-notion-text-secondary-dark"></span>
                    <div class="flex gap-2">
                        <button type="button" id="prevBtn" disabled
                                class="px-3 py-1 text-xs bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark
                                       border border-notion-border dark:border-notion-border-dark rounded
                                       text-notion-text dark:text-notion-text-dark
                                       hover:bg-notion-bg-hover dark:hover:bg-notion-bg-hover-dark transition
                                       disabled:opacity-50 disabled:cursor-not-allowed">
                            ì´ì „
                        </button>
                        <button type="button" id="nextBtn" disabled
                                class="px-3 py-1 text-xs bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark
                                       border border-notion-border dark:border-notion-border-dark rounded
                                       text-notion-text dark:text-notion-text-dark
                                       hover:bg-notion-bg-hover dark:hover:bg-notion-bg-hover-dark transition
                                       disabled:opacity-50 disabled:cursor-not-allowed">
                            ë‹¤ìŒ
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reindexing Section -->
        <div class="mt-8 border border-notion-border dark:border-notion-border-dark rounded-lg">
            <div class="border-b border-notion-border dark:border-notion-border-dark px-4 py-3 bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark rounded-t-lg flex items-center justify-between">
                <div>
                    <h2 class="text-sm font-semibold text-notion-text dark:text-notion-text-dark">ì¬ì¸ë±ì‹±</h2>
                    <p class="text-xs text-notion-text-secondary dark:text-notion-text-secondary-dark mt-0.5">
                        ìš©ì–´ ì‚¬ì „ ë³€ê²½ ì‹œ Elasticsearch ì¸ë±ìŠ¤ë¥¼ ì¬êµ¬ì„±í•©ë‹ˆë‹¤
                    </p>
                </div>
                <div id="reindexStatus" class="flex items-center gap-2">
                    <span id="reindexStatusBadge" class="hidden px-2 py-0.5 text-xs rounded-full"></span>
                </div>
            </div>

            <div class="p-4">
                <!-- Reindex Error Message -->
                <div id="reindexError" class="hidden mb-4 px-3 py-2 text-sm bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800 rounded"></div>

                <!-- Reindex Success Message -->
                <div id="reindexSuccess" class="hidden mb-4 px-3 py-2 text-sm bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800 rounded"></div>

                <!-- Reindex Result -->
                <div id="reindexResult" class="hidden mb-4 p-4 bg-notion-bg-secondary dark:bg-notion-bg-secondary-dark rounded border border-notion-border dark:border-notion-border-dark">
                    <h3 class="text-sm font-medium text-notion-text dark:text-notion-text-dark mb-3">ì¬ì¸ë±ì‹± ê²°ê³¼</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                        <div>
                            <span class="text-notion-text-secondary dark:text-notion-text-secondary-dark">ì´ì „ ì¸ë±ìŠ¤</span>
                            <p id="resultPrevIndex" class="font-mono text-notion-text dark:text-notion-text-dark">-</p>
                        </div>
                        <div>
                            <span class="text-notion-text-secondary dark:text-notion-text-secondary-dark">ìƒˆ ì¸ë±ìŠ¤</span>
                            <p id="resultNewIndex" class="font-mono text-notion-text dark:text-notion-text-dark">-</p>
                        </div>
                        <div>
                            <span class="text-notion-text-secondary dark:text-notion-text-secondary-dark">ë¬¸ì„œ ìˆ˜</span>
                            <p id="resultDocCount" class="font-mono text-notion-text dark:text-notion-text-dark">-</p>
                        </div>
                        <div>
                            <span class="text-notion-text-secondary dark:text-notion-text-secondary-dark">ì‚¬ìš©ì ì‚¬ì „ / ë™ì˜ì–´</span>
                            <p id="resultDictSize" class="font-mono text-notion-text dark:text-notion-text-dark">-</p>
                        </div>
                    </div>
                </div>

                <div class="flex items-center gap-3">
                    <button type="button" id="reindexBtn"
                            class="px-4 py-2 text-sm bg-orange-500 text-white rounded hover:bg-orange-600 transition
                                   disabled:opacity-50 disabled:cursor-not-allowed">
                        ì¬ì¸ë±ì‹± ì‹¤í–‰
                    </button>
                    <span class="text-xs text-notion-text-secondary dark:text-notion-text-secondary-dark">
                        ìš©ì–´ ì¶”ê°€/ìˆ˜ì • í›„ ì‹¤í–‰í•˜ë©´ ê²€ìƒ‰ í’ˆì§ˆì´ í–¥ìƒë©ë‹ˆë‹¤
                    </span>
                </div>
            </div>
        </div>
    </main>

    <script>
        // State
        let allChannels = [];
        let currentPage = 0;
        const pageSize = 10;

        // Elements
        const botTokenInput = document.getElementById('botToken');
        const loadChannelsBtn = document.getElementById('loadChannelsBtn');
        const channelSection = document.getElementById('channelSection');
        const channelSelect = document.getElementById('channelId');
        const channelSearch = document.getElementById('channelSearch');
        const workspaceIdInput = document.getElementById('workspaceId');
        const workspaceNameSpan = document.getElementById('workspaceName');
        const channelCountSpan = document.getElementById('channelCount');
        const tokenError = document.getElementById('tokenError');
        const collectSuccess = document.getElementById('collectSuccess');
        const collectBtn = document.getElementById('collectBtn');
        const refreshBtn = document.getElementById('refreshBtn');
        const docCount = document.getElementById('docCount');
        const emptyState = document.getElementById('emptyState');
        const documentsList = document.getElementById('documentsList');
        const pagination = document.getElementById('pagination');
        const pageInfo = document.getElementById('pageInfo');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        // Load channels
        loadChannelsBtn.addEventListener('click', async function() {
            const botToken = botTokenInput.value.trim();
            if (!botToken) {
                showError('Bot Tokenì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            loadChannelsBtn.disabled = true;
            loadChannelsBtn.textContent = 'ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...';
            hideError();
            hideSuccess();

            try {
                const formData = new FormData();
                formData.append('botToken', botToken);

                const response = await fetch('/demo/slack/workspace-info', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (!data.ok) {
                    showError(data.error || 'ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                workspaceIdInput.value = data.workspaceId;
                workspaceNameSpan.textContent = data.workspaceName;
                allChannels = data.channels;
                channelCountSpan.textContent = '(' + allChannels.length + 'ê°œ ì±„ë„)';
                renderChannels(allChannels);
                channelSection.classList.remove('hidden');
                channelSelect.addEventListener('change', function() {
                    collectBtn.disabled = !this.value;
                });
            } catch (e) {
                showError('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + e.message);
            } finally {
                loadChannelsBtn.disabled = false;
                loadChannelsBtn.textContent = 'ì±„ë„ ë¶ˆëŸ¬ì˜¤ê¸°';
            }
        });

        // Search channels
        channelSearch.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            if (!query) {
                renderChannels(allChannels);
                return;
            }
            const filtered = allChannels.filter(ch => ch.name.toLowerCase().includes(query));
            renderChannels(filtered);
        });

        function renderChannels(channels) {
            channelSelect.innerHTML = '';
            channels.forEach(function(channel) {
                const option = document.createElement('option');
                option.value = channel.id;
                option.textContent = (channel.isPrivate ? 'ğŸ”’ ' : '# ') + channel.name;
                channelSelect.appendChild(option);
            });
            collectBtn.disabled = true;
        }

        // Collect messages
        collectBtn.addEventListener('click', async function() {
            const botToken = botTokenInput.value.trim();
            const workspaceId = workspaceIdInput.value;
            const channelId = channelSelect.value;

            if (!channelId) {
                showError('ì±„ë„ì„ ì„ íƒí•˜ì„¸ìš”.');
                return;
            }

            collectBtn.disabled = true;
            collectBtn.textContent = 'ìˆ˜ì§‘ ì¤‘...';
            hideError();
            hideSuccess();

            try {
                const formData = new FormData();
                formData.append('botToken', botToken);
                formData.append('workspaceId', workspaceId);
                formData.append('channelId', channelId);

                const oldestDate = document.getElementById('oldestDate').value;
                const latestDate = document.getElementById('latestDate').value;

                if (oldestDate) {
                    const ts = new Date(oldestDate).getTime() / 1000;
                    formData.append('oldest', ts.toFixed(6));
                }
                if (latestDate) {
                    const ts = new Date(latestDate).getTime() / 1000;
                    formData.append('latest', ts.toFixed(6));
                }

                const response = await fetch('/demo/slack/collect-ajax', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (data.error) {
                    showError(data.error);
                } else {
                    showSuccess(`ìˆ˜ì§‘ ì™„ë£Œ: ${data.messageCount}ê°œ ë©”ì‹œì§€, ${data.successCount}ê°œ ì €ì¥ ì„±ê³µ`);
                    loadDocuments();
                }
            } catch (e) {
                showError('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + e.message);
            } finally {
                collectBtn.disabled = false;
                collectBtn.textContent = 'ìˆ˜ì§‘ ì‹œì‘';
            }
        });

        // Load documents
        async function loadDocuments() {
            try {
                const response = await fetch(`/demo/source-documents/api?page=${currentPage}&size=${pageSize}`);
                const data = await response.json();

                docCount.textContent = data.totalElements + 'ê°œ';

                if (data.documents.length === 0) {
                    emptyState.classList.remove('hidden');
                    documentsList.classList.add('hidden');
                    pagination.classList.add('hidden');
                } else {
                    emptyState.classList.add('hidden');
                    documentsList.classList.remove('hidden');
                    pagination.classList.remove('hidden');

                    documentsList.innerHTML = data.documents.map(doc => `
                        <div class="border border-notion-border dark:border-notion-border-dark rounded p-3">
                            <div class="flex items-center justify-between mb-2">
                                <span class="inline-flex items-center px-2 py-0.5 text-xs font-medium bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 rounded">
                                    ${doc.metadata.source}
                                </span>
                                <time class="text-xs text-notion-text-secondary dark:text-notion-text-secondary-dark">
                                    ${formatTimestamp(doc.timestamp)}
                                </time>
                            </div>
                            <p class="text-sm text-notion-text dark:text-notion-text-dark whitespace-pre-wrap break-words">${escapeHtml(doc.content)}</p>
                        </div>
                    `).join('');

                    pageInfo.textContent = `${data.currentPage + 1} / ${data.totalPages} í˜ì´ì§€`;
                    prevBtn.disabled = !data.hasPrevious;
                    nextBtn.disabled = !data.hasNext;
                }
            } catch (e) {
                console.error('Failed to load documents:', e);
            }
        }

        function formatTimestamp(ts) {
            const date = new Date(ts);
            return date.toLocaleString('ko-KR');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        refreshBtn.addEventListener('click', () => {
            currentPage = 0;
            loadDocuments();
        });

        prevBtn.addEventListener('click', () => {
            if (currentPage > 0) {
                currentPage--;
                loadDocuments();
            }
        });

        nextBtn.addEventListener('click', () => {
            currentPage++;
            loadDocuments();
        });

        function showError(message) {
            tokenError.textContent = message;
            tokenError.classList.remove('hidden');
        }

        function hideError() {
            tokenError.classList.add('hidden');
        }

        function showSuccess(message) {
            collectSuccess.textContent = message;
            collectSuccess.classList.remove('hidden');
        }

        function hideSuccess() {
            collectSuccess.classList.add('hidden');
        }

        // Initial load
        loadDocuments();

        // Reindexing
        const reindexBtn = document.getElementById('reindexBtn');
        const reindexError = document.getElementById('reindexError');
        const reindexSuccess = document.getElementById('reindexSuccess');
        const reindexResult = document.getElementById('reindexResult');
        const reindexStatusBadge = document.getElementById('reindexStatusBadge');

        async function checkReindexStatus() {
            try {
                const response = await fetch('/demo/reindex/status');
                const data = await response.json();

                if (data.reindexingRequired) {
                    reindexStatusBadge.textContent = 'ì¬ì¸ë±ì‹± í•„ìš”';
                    reindexStatusBadge.className = 'px-2 py-0.5 text-xs rounded-full bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400';
                } else {
                    reindexStatusBadge.textContent = 'ìµœì‹  ìƒíƒœ';
                    reindexStatusBadge.className = 'px-2 py-0.5 text-xs rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400';
                }
                reindexStatusBadge.classList.remove('hidden');
            } catch (e) {
                console.error('Failed to check reindex status:', e);
            }
        }

        reindexBtn.addEventListener('click', async function() {
            reindexBtn.disabled = true;
            reindexBtn.textContent = 'ì¬ì¸ë±ì‹± ì¤‘...';
            reindexError.classList.add('hidden');
            reindexSuccess.classList.add('hidden');
            reindexResult.classList.add('hidden');

            try {
                const response = await fetch('/demo/reindex', {
                    method: 'POST'
                });

                const data = await response.json();

                if (!data.success) {
                    reindexError.textContent = data.error || 'ì¬ì¸ë±ì‹±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                    reindexError.classList.remove('hidden');
                } else {
                    reindexSuccess.textContent = 'ì¬ì¸ë±ì‹±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.';
                    reindexSuccess.classList.remove('hidden');

                    document.getElementById('resultPrevIndex').textContent = data.previousIndex || '(ì—†ìŒ)';
                    document.getElementById('resultNewIndex').textContent = data.newIndex;
                    document.getElementById('resultDocCount').textContent = data.documentCount + 'ê°œ';
                    document.getElementById('resultDictSize').textContent = data.userDictionarySize + 'ê°œ / ' + data.synonymRulesSize + 'ê°œ';
                    reindexResult.classList.remove('hidden');

                    checkReindexStatus();
                }
            } catch (e) {
                reindexError.textContent = 'ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + e.message;
                reindexError.classList.remove('hidden');
            } finally {
                reindexBtn.disabled = false;
                reindexBtn.textContent = 'ì¬ì¸ë±ì‹± ì‹¤í–‰';
            }
        });

        // Check reindex status on load
        checkReindexStatus();
    </script>
</body>
</html>
